ParseInt â† {
  +Â´(10 â‹† âŒ½â†•â‰ ğ•©) Ã— ('0'-Ëœ ğ•©)
}âš‡1

ToBase2 â† {
  b â† '0' + 2{âŒ½ğ•—|âŒŠâˆ˜Ã·âŸœğ•—âŸ(â†•1+Â·âŒŠğ•—â‹†â¼1âŒˆâŠ¢)} ğ•©
  ((36-â‰ b)â¥Š'0') âˆ¾ b
}âš‡0

# This is really jank, once predicates come to CBQN it will be nicer
ParseE â† {
  0 ParseE str :
    âŸ¨
     ParseInt (4â†“â†•âŠ‘(ğ•© âŠ ']')) âŠ str,
     ToBase2 (ParseInt (2+âŠ‘(str âŠ '=')) â†“ str),
    âŸ© ;
  1 ParseE str :
    7 â†“ str 
}

Parse â† {
  ("mask" â‰¡ (â†•4) âŠ ğ•©) ParseE ğ•©
}âš‡1


RunStep â† {
  âŸ¨mask, memâŸ© RunStep line:
    (36=â‰ ğ•©)â—¶âŸ¨
      âŸ¨ğ•©, memâŸ©
      âŸ¨mask, âŸ©
    âŸ©
}

parsed â† ParseÂ¨ â€¢FLines "data.txt"

â€¢Out â€¢Repr Parse "mask = X100110110X011000101000101XX11001X11"
â€¢Out â€¢Repr Parse "mem[54866] = 120526"

#â€¢Out â€¢Repr ToBase2 1838761

#â€¢OutÂ¨ â€¢ReprÂ¨ parsed
# â€¢Out âŸ¨2, 3âŸ© RunStep "sdf"
