input â† â€¢FLines "data.txt"
Split â† (â€¢Import "strings.bqn").Split

ParseNat â† {
  +Â´ (10 â‹† (âŒ½â†•â‰ ğ•©)) Ã— ğ•© - '0' 
}

ParseLine â† {
  âŸ¨a, bc, dâŸ© â† ',' Split ğ•©
  âŸ¨b, arrow, câŸ© â† ' ' Split bc
  (ParseNatÂ¨ (a â‹ˆ b)) â‹ˆ (ParseNatÂ¨ (c â‹ˆ d))
}

LineIncluding â† {
    LineIncluding âŸ¨âŸ¨a, bâŸ©, âŸ¨c, dâŸ©âŸ©: a = c ? aâŠ¸â‹ˆÂ¨ (b âŒŠ d) + â†• 1 + (| b - d) ;
    LineIncluding âŸ¨âŸ¨a, bâŸ©, âŸ¨c, dâŸ©âŸ©: b = d ? âŒ½Â¨ LineIncluding âŸ¨âŸ¨b, aâŸ©, âŸ¨d, câŸ©âŸ© ;

    LineIncluding âŸ¨âŸ¨a, bâŸ©, âŸ¨c, dâŸ©âŸ©: (a < c) âˆ§ (b < d) ? (<âŸ¨a, bâŸ©) + â‹ˆËœÂ¨(â†•1 + (c - a)) ;
    LineIncluding âŸ¨âŸ¨a, bâŸ©, âŸ¨c, dâŸ©âŸ©: (a > c) âˆ§ (b < d) ? (<âŸ¨a, bâŸ©) + (<âŸ¨-1, 1âŸ©) Ã— â‹ˆËœÂ¨(â†•1 + (a - c)) ;

    LineIncluding âŸ¨âŸ¨a, bâŸ©, âŸ¨c, dâŸ©âŸ©: (a > c) âˆ§ (b > d) ? LineIncluding âŸ¨âŸ¨c, dâŸ©, âŸ¨a, bâŸ©âŸ© ;
    LineIncluding âŸ¨âŸ¨a, bâŸ©, âŸ¨c, dâŸ©âŸ©: (a < c) âˆ§ (b > d) ? LineIncluding âŸ¨âŸ¨c, dâŸ©, âŸ¨a, bâŸ©âŸ©
}

Mark â† { (1âŠ¸+)âŒ¾(ğ•©âŠ¸âŠ‘) ğ•¨ }

HorizVert â† {
    (+Â´ =Â´ ğ•©) > 0
}
data â† ParseLineÂ¨ input
p1_data â† (HorizVertÂ¨ data) / data

mat â† âŸ¨1000, 1000âŸ© â¥Š 0

map_p1 â† â‰+Â´matâŠ¸MarkÂ¨ LineIncludingÂ¨ p1_data
map_p2 â† â‰+Â´matâŠ¸MarkÂ¨ LineIncludingÂ¨ data
â€¢Show +Â´+Ë map_p1 > 1
â€¢Show +Â´+Ë map_p2 > 1
