primes â† â€¢Import "primes.bqn"
input â† (â€¢file.Lines "data.txt") - '0'

width â† âŠ‘ â‰ Â¨ input
height â† â‰  input
data â† âŸ¨height, widthâŸ© â¥Š âˆ¾input

min_locs â† (âŒŠÂ´ âŸ¨âˆâŠ¸Â»Ë˜ data, âˆâŠ¸Â«Ë˜ data, (âˆâŠ¸Â«Ë˜âŒ¾â‰) data, (âˆâŠ¸Â»Ë˜âŒ¾â‰) dataâŸ©) > data

â€¢Show +Â´+Ë min_locs Ã— (1 + data)

wall â† data â‰  9
primelist â† primes.PrimesTo 100000

LargestFactor â† {
  LargestFactor 0: 0;
  LargestFactor n: âŒˆÂ´ primes.Factor n
}

Color â† {
  Color visited: {
    shifted â† +Â´ âŸ¨Â»Ë˜ visited, Â«Ë˜ visited, (Â«Ë˜âŒ¾â‰) visited, (Â»Ë˜âŒ¾â‰) visited, visitedâŸ©
    LargestFactorÂ¨ shifted Ã— wall
  }
}

Iterate â† {
  prevnum Iterate mat: prevnum = +Â´+Ë 0 = ğ•© ? mat;
  prevnum Iterate mat: (+Â´+Ë 0 = mat) Iterate Color mat
}

# The primes store information about which section they are part of
pmat â† (((((0 âˆ¾ 1 â†“ âˆŠ)Ã—âŠ£)+`)âŒ¾â¥Š) min_locs) âŠ 0 âˆ¾ 2 â†“ primelist
o â† âˆ¨ â‰ Â¨ âŠ” (0âŠ¸â‰  / âŠ¢) â¥Š 0 Iterate pmat
pmat2 â† (((((0 âˆ¾ 1 â†“ âˆŠ)Ã—âŠ£)+`)âŒ¾â¥Š) min_locs) âŠ 0 âˆ¾ 9 â†“ primelist
p â† âˆ¨ â‰ Â¨ âŠ” (0âŠ¸â‰  / âŠ¢) â¥Š 0 Iterate pmat
â€¢Show o â‰¡ p
