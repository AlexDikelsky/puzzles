input â† â€¢file.Lines "data.txt"

startstr â† âŠ‘ input
subs â† (2âŠ¸â†‘ â‹ˆ Â¯1âŠ¸âŠ‘)Â¨ 2 â†“ input
âŸ¨keys, valsâŸ© â† (âŠ‘Â¨ â‹ˆ 1âŠ¸âŠ‘Â¨) subs

Hash â† {
  ğ•Š âŸ¨c, dâŸ©:
    âŸ¨a, bâŸ© â† âŸ¨c, dâŸ© - 'A'
    (26 Ã— a) + b
}

UnHash â† {
  ğ•Š n:
    ((âŒŠ n Ã· 26) â‹ˆ (26 | n)) + 'A'
}

Split â† {
  ğ•Š âŸ¨âŸ¨a, bâŸ©, câŸ©:
    âŸ¨Hash âŸ¨a, câŸ©,  Hash âŸ¨c, bâŸ©âŸ©
}

len â† Hash "ZZ"

# Assert this hash works
! ((UnHashÂ¨ HashÂ¨) â‰¡ âŠ£) âŠ‘Â¨ subs 

startmap â† /â¼ (âˆ§ HashË˜ 2 â†• startstr) âˆ¾ len

Step â† {
  ğ•Š map:
    toapply â† ((HashÂ¨ keys) âŠ map) / subs
    /â¼ âˆ§ len âˆ¾ âˆ¾ SplitÂ¨ toapply
}

indices â† âŠ‘Â¨ UnHashÂ¨ / (1âŠ¸â†“âŒ¾âŒ½)  StepâŸ10 startmap

maxes â† (0âŠ¸â‰  / { ğ•© â‹ˆËœÂ¨ 'A' + â†•â‰ ğ•© }) â‰ Â¨ âŠ” ((Â¯1 âŠ‘ startstr) âˆ¾ indices) - 'A'
âŸ¨k, vâŸ© â† (âŠ‘Â¨ â‹ˆ 1âŠ¸âŠ‘Â¨) maxes
â€¢Show (âŒˆÂ´ v) - (âŒŠÂ´ v)
