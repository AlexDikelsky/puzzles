input â† â€¢file.Lines "data.txt"
str â† â€¢Import "strings.bqn"

Color â† {
  ğ•Š 0: ' ';
  ğ•Š 1: '#'
}

mask â† 'f' = âŠ‘Â¨ 1 â†‘Â¨ input
folds â† (Â¯1âŠ¸âŠ‘âˆ˜âŠ‘ âˆ¾ (str.ToNats 1âŠ¸âŠ‘))Â¨ '='âŠ¸str.SplitÂ¨ mask / input  
âŸ¨xs, ysâŸ© â† (âŠ‘Â¨ â‹ˆ 1âŠ¸âŠ‘Â¨) âŒ½ âˆ¾Â¨ str.ToNatsÂ¨Â¨ ','âŠ¸str.SplitÂ¨ 1âŠ¸â†“ âŒ½ (Â¬mask) / input

Fold â† {
  âŸ¨'y', nâŸ© ğ•Š âŸ¨xs, ysâŸ©:
    xs â‹ˆ â¥Š | ys - (2Ã—n) Ã— (ys > n) ;
  âŸ¨'x', nâŸ© ğ•Š âŸ¨xs, ysâŸ©:
    ys â‹ˆËœ â¥Š | xs - (2Ã—n) Ã— (xs > n)
}

â€¢Show â‰  â· (âŠ‘ â‹ˆÂ¨ 1âŠ¸âŠ‘) (âŠ‘ folds) Fold âŸ¨xs, ysâŸ©

asâ€¿bs â† âŸ¨xs, ysâŸ© FoldÂ´ âŒ½ folds

mask2 â† ('y'âŠ¸= 0âŠ¸âŠ‘Â¨) folds

âŸ¨h, wâŸ© â† Â¯1âŠ¸âŠ‘Â¨ Â¯1âŠ¸âŠ‘Â¨ ((mask2 / âŠ£) â‹ˆ ((Â¬mask2) / âŠ£)) folds

â€¢Show hâ€¿w â¥Š ColorÂ¨ (â†• wÃ—h) âˆŠ â¥Š (bs Ã— w) + as
