data â† â€¢FLines "data.txt"

ParseNat â† {
  +Â´ (10 â‹† (âŒ½â†•â‰ ğ•©)) Ã— ğ•© - '0' 
}

ParseStart1 â† {
  'f': âŸ¨ 1, 0âŸ© ;
  'd': âŸ¨0,  1âŸ© ;
  'u': âŸ¨0, Â¯1âŸ©
}

ParseLine1 â† {
  (ParseStart1 âŠ‘ ğ•©) Ã— ParseNat (1 + ğ•© âŠ " ") â†“ ğ•©
}

Run2 â† {
  âŸ¨'f', valâŸ© Run2 âŸ¨width, depth, aimâŸ©: {
    âŸ¨width + val, depth + (aim Ã— val), aimâŸ©
  } ;
  âŸ¨'d', valâŸ© Run2 âŸ¨width, depth, aimâŸ©: {
    âŸ¨width, depth, aim + valâŸ©
  } ;
  âŸ¨'u', valâŸ© Run2 âŸ¨width, depth, aimâŸ©: {
    âŸ¨width, depth, aim - valâŸ©
  }
}

ParseLine2 â† {
  (âŠ‘ ğ•©) âˆ¾ ParseNat (1 + ğ•© âŠ " ") â†“ ğ•©
}

â€¢Out Ã—Â´ +Â´ ParseLine1Â¨ data
â€¢Out Ã—Â´ 2 â†‘ (âŸ¨0, 0, 0âŸ© Run2Â´ âŒ½ ParseLine2Â¨ data)
