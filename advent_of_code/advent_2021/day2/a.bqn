data â† â€¢FLines "data.txt"

ParseNat â† {
  +Â´ (10 â‹† (âŒ½â†•â‰ ğ•©)) Ã— ğ•© - '0' 
}

ParseLine â† {
  (âŠ‘ ğ•©) âˆ¾ ParseNat (1 + ğ•© âŠ " ") â†“ ğ•©
}

Run1 â† {
  âŸ¨'f', valâŸ© Run1 âŸ¨width, depthâŸ©: âŸ¨width + val, depthâŸ© ;
  âŸ¨'d', valâŸ© Run1 âŸ¨width, depthâŸ©: âŸ¨width, depth + valâŸ© ;
  âŸ¨'u', valâŸ© Run1 âŸ¨width, depthâŸ©: âŸ¨width, depth - valâŸ©
}

Run2 â† {
  âŸ¨'f', valâŸ© Run2 âŸ¨width, depth, aimâŸ©: {
    âŸ¨width + val, depth + (aim Ã— val), aimâŸ©
  } ;
  âŸ¨'d', valâŸ© Run2 âŸ¨width, depth, aimâŸ©: {
    âŸ¨width, depth, aim + valâŸ©
  } ;
  âŸ¨'u', valâŸ© Run2 âŸ¨width, depth, aimâŸ©: {
    âŸ¨width, depth, aim - valâŸ©
  }
}


â€¢Out Ã—Â´ âŸ¨0, 0âŸ© Run1Â´ ParseLineÂ¨ data
â€¢Out Ã—Â´ 2 â†‘ (âŸ¨0, 0, 0âŸ© Run2Â´ âŒ½ ParseLineÂ¨ data)
