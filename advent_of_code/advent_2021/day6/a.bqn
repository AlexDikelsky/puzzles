Split â† (â€¢Import "strings.bqn").Split

ParseNat â† {
  +Â´ (10 â‹† (âŒ½â†•â‰ ğ•©)) Ã— ğ•© - '0' 
}

input â† ParseNatÂ¨ ',' Split âŠ‘ â€¢FLines "data.txt"

dat â† (âŠ‘ â‹ˆ â‰ )Â¨ ((0â‰ â‰ Â¨)/âŠ£) âŠ”Ëœinput

Step â† {
  shifted â† 1 âŒ½ ğ•©  
  ((Â¯1 âŠ‘ shifted)âŠ¸+)âŒ¾(6âŠ¸âŠ‘) shifted
}

A â† { 
  b A âŸ¨idx, vâŸ©: {
    K â† { 
      K âŸ¨idx, vâŸ©: ((vâŠ¸+) âŒ¾ (idxâŠ¸âŠ‘)) 
    }
    a â† K âŸ¨idx, vâŸ©
    A b
  }
}
B â† {
  v B âŸ¨âŸ© : v ;
  v B pairs: (v A âŠ‘ pairs) B 1 â†“ pairs 
}

â€¢Show +Â´(StepâŸ80) (9â¥Š0) B dat
â€¢Show +Â´(StepâŸ256) (9â¥Š0) B dat
