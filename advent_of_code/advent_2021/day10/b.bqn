data â† â€¢file.Lines "data.txt"

open â† "{<[("
close â† "}>])"

Score1 â† {
  Score1 '}': 1197;
  Score1 '>': 25137;
  Score1 ']': 57;
  Score1 ')': 3
}

Score2 â† {
  Score2 '(': 1;
  Score2 '[': 2;
  Score2 '{': 3;
  Score2 '<': 4;
  Score x: x ! 0
}

Score3 â† {
  0 { ((5 Ã— ğ•©) + Score2 ğ•¨) }Â´ ğ•©
}

Process1 â† {
  stack Process1 âŸ¨âŸ©: {
    0 # Incomplete or fine
  };
  stack Process1 str: âŠ‘ (âŠ‘ str) âˆŠ open ? {
    ((âŠ‘ str) âˆ¾ stack) Process1 1 â†“ str
  };
  stack Process1 str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((â‰ stack) > 0) ? {
    âŸ¨s, stâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) stack
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str

    ((close âŠ x) â‰¡ (open âŠ s))â—¶âŸ¨Score1 x, st Process1 xsâŸ© @
  };
  stack Process1 str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((=stack) > 0) ? {
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str
    Score1 x
  }
}

Process â† {
  âŸ¨âŸ© Process âŸ¨âŸ©: {
    âŸ¨âŸ©
  };
  stack Process âŸ¨âŸ©: {
    stack
  };
  stack Process str: âŠ‘ (âŠ‘ str) âˆŠ open ? {
    ((âŠ‘ str) âˆ¾ stack) Process 1 â†“ str
  };
  stack Process str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((â‰ stack) > 0) ? {
    âŸ¨s, stâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) stack
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str

    ((close âŠ x) â‰¡ (open âŠ s))â—¶âŸ¨âŸ¨âŸ©, st Process xsâŸ© @
  };
  stack Process str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((=stack) > 0) ? {
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str
    âŸ¨âŸ©
  }
}

â€¢Show +Â´ âŸ¨âŸ©âŠ¸Process1Â¨ data
z â† (0âŠ¸â‰  / âŠ£) (âˆ§ (Score3Â¨ âŒ½Â¨ âŸ¨âŸ©âŠ¸ProcessÂ¨ data))
â€¢Show ((Â¯1 + â‰  z) Ã· 2) âŠ‘ z
