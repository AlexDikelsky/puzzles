data â† â€¢file.Lines "data.txt"

open â† "{<[("
close â† "}>])"

Score2 â† {
  Score2 '(': 1;
  Score2 '[': 2;
  Score2 '{': 3;
  Score2 '<': 4;
  Score x: x ! 0
}

Score1 â† {
  Score1 '>': 25137;
  Score1 '}': 1197;
  Score1 ']': 57;
  Score1 ')': 3
}

Process â† {
  âŸ¨âŸ© Process âŸ¨âŸ©: {
    âŸ¨0, 0âŸ©
  };
  stack Process âŸ¨âŸ©: {
    âŸ¨0, 0 { ((5âŠ¸Ã— ğ•©) + Score2 ğ•¨) }Â´ âŒ½ stackâŸ©
  };
  stack Process str: âŠ‘ (âŠ‘ str) âˆŠ open ? {
    ((âŠ‘ str) âˆ¾ stack) Process 1 â†“ str
  };
  stack Process str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((â‰ stack) > 0) ? {
    âŸ¨s, stâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) stack
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str

    ((close âŠ x) â‰¡ (open âŠ s))â—¶âŸ¨âŸ¨Score1 x, 0âŸ©, st Process xsâŸ© @
  };
  stack Process str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((=stack) > 0) ? {
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str
    âŸ¨Score1 xâŸ©
  }
}

â€¢Show +Â´ âŠ‘Â¨ âŸ¨âŸ©âŠ¸ProcessÂ¨ data
â€¢Show ({2âŠ¸(Ã·Ëœ) Â¯1 + â‰  ğ•©} âŠ‘ âŠ¢) (0âŠ¸â‰  / âŠ¢) (âˆ§ 1âŠ¸âŠ‘Â¨ âŸ¨âŸ©âŠ¸ProcessÂ¨ data)
