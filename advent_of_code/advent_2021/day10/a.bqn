data â† â€¢file.Lines "data.txt"

open â† "{<[("
close â† "}>])"


Score2 â† {
  Score2 '(': 1;
  Score2 '[': 2;
  Score2 '{': 3;
  Score2 '<': 4;
  Score x: x ! 0
}

Score1 â† {
  Score1 '>': 25137;
  Score1 '}': 1197;
  Score1 ']': 57;
  Score1 ')': 3
}

Score3 â† {  ğ•© }

Process1 â† {
  stack Process1 âŸ¨âŸ©: {
    0
  };
  stack Process1 str: âŠ‘ (âŠ‘ str) âˆŠ open ? {
    ((âŠ‘ str) âˆ¾ stack) Process1 1 â†“ str
  };
  stack Process1 str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((â‰ stack) > 0) ? {
    âŸ¨s, stâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) stack
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str

    ((close âŠ x) â‰¡ (open âŠ s))â—¶âŸ¨Score1 x, st Process1 xsâŸ© @
  };
  stack Process1 str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((=stack) > 0) ? {
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str
    Score1 x
  }
}

Process â† {
  âŸ¨âŸ© Process âŸ¨âŸ©: {
    0
  };
  stack Process âŸ¨âŸ©: {
    0 { ((5âŠ¸Ã— ğ•©) + Score2 ğ•¨) }Â´ âŒ½ stack
  };
  stack Process str: âŠ‘ (âŠ‘ str) âˆŠ open ? {
    ((âŠ‘ str) âˆ¾ stack) Process 1 â†“ str
  };
  stack Process str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((â‰ stack) > 0) ? {
    âŸ¨s, stâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) stack
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str

    ((close âŠ x) â‰¡ (open âŠ s))â—¶âŸ¨0, st Process xsâŸ© @
  };
  stack Process str: (âŠ‘ (âŠ‘ str) âˆŠ close) âˆ§ ((=stack) > 0) ? {
    âŸ¨x, xsâŸ© â† (âŠ‘â‹ˆ1âŠ¸â†“) str
    0
  }
}

â€¢Show +Â´ âŸ¨âŸ©âŠ¸Process1Â¨ data
â€¢Show ({2âŠ¸(Ã·Ëœ) Â¯1 + â‰  ğ•©} âŠ‘ âŠ¢) (0âŠ¸â‰  / âŠ¢) (âˆ§ âŸ¨âŸ©âŠ¸ProcessÂ¨ data)
